<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HWForm16</title>
  <style>
    * {
      margin: 0.5%;
      /* font: 1.2rem "Fira Sans", sans-serif; */
      font: small-caps bold 16px sans-serif;
    }

    h1 {
      color: green;
    }

    .error {
      color: red;
      display: none;
      font-size: 11px;
    }
  </style>
</head>

<body>
  <form id="myForm">
    <section>
      <h1>Форма регистрации</h1>
      <!-- Поля формы -->
      <input type="text" name="username" id="username" placeholder="Имя пользователя">
      <span class="error" id="usernameError"></span>
    </section>

    <section>
      <input type="email" name="email" id="email" placeholder="Email">
      <span class="error" id="emailError"></span>
    </section>

    <section>
      <input type="number" name="age" id="age" placeholder="Возраст" min="18" max="99" required>
      <span class="error" id="ageError"></span>
    </section>

    <section>
      <legend>Выберите пол</legend>
      <div>
        <input type="radio" name="gender" value="Мужчина" checked>
        <label for="">Мужчина</label>
      </div>
      <div>
        <input type="radio" name="gender" value="Женщина">
        <label for="">Женщина</label>
      </div>
    </section>

    <section>
      <h2>Выбор профессии</h2>
      <select name="" id="" placeholder="Выберите профессию" required>
        <option value="">Врач</option>
        <option value="">Программист</option>
        <option value="">Учитель</option>
        <option value="">Дизайнер</option>
        <option value="">Инженер</option>
        <option value="">Продавец</option>
        <option value="">Другое</option>
      </select>
    </section>

    <section>
      <!-- Чекбокс для согласия с условиями -->
      <input type="checkbox" name="agreeTerms" id="agreeTerms">
      <label for="agreeTerms">Я согласен с условиями</label>
      <span class="error" id="termsError"></span>
    </section>
    <section>
      <!-- Кнопка отправки, изначально заблокирована -->
      <button type="submit" name="submitBtn" id="submitBtn" disabled>Отправить</button>
    </section>
  </form>

  <script>
    // обработка согласия
    document.getElementById('agreeTerms').addEventListener('change', function () {
      // Получаем кнопку отправки и чекбокс
      let submitBtn = document.getElementById('submitBtn');
      let agreeTermsCheckbox = document.getElementById('agreeTerms');

      // Разблокируем или блокируем кнопку в зависимости от состояния чекбокса
      submitBtn.disabled = !agreeTermsCheckbox.checked;
    });

    // обработка ошибок
    const form = document.forms.myForm;
    const userNameInput = form.elements.username;
    const emailInput = form.elements.email;
    const ageInput = form.elements.age;
    const agreeTermsCheckbox = form.elements.agreeTerms;

    const userNameError = document.getElementById('usernameError');
    const emailError = document.getElementById('emailError');
    const ageError = document.getElementById('ageError')
    const termsError = document.getElementById('termsError');

    form.addEventListener('submit', function (evt) {
      evt.preventDefault();
      let hasError = false;

      // Очистка предыдущих сообщений об ошибках
      userNameError.style.display = 'none';
      emailError.style.display = 'none';
      ageError.style.display = 'none';
      termsError.style.display = 'none';

      if (userNameInput.value === '') {
        userNameError.textContent = 'Введите имя пользователя.';
        userNameError.style.display = 'block';
        hasError = true;
      }

      if (validateEmail(emailInput.value) === false) {
        emailError.textContent = 'Введите корректный email.';
        emailError.style.display = 'block';
        hasError = true;
      }

      if (ageInput.value === '') {
        ageError.textContent = 'Введите возраст.';
        ageError.style.display = 'block';
        hasError = true;
      }

      if (agreeTermsCheckbox.checked === false) {
        termsError.textContent = 'Необходимо согласие с условиями.';
        termsError.style.display = 'block';
        hasError = true;
      }

      if (hasError === false) {
        alert('Форма успешно отправлена!');
      }
    });

    function validateEmail(email) {
      let regex = /^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,4}$/;
      return regex.test(email);
    }
    // 
  </script>
</body>

</html>